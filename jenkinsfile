node{
  stage('clone'){
    git 'https://github.com/PrakashGit404/VProfile'
  }
  stage('compile-pack'){
    def mvnHome = tool name: 'mvn', type: 'maven'
    sh "${mvnHome}/bin/mvn clean compile package install"
  }
  stage('sonar qube'){
    def mvnHome = tool name: 'mvn', type: 'maven'
      withSonarQubeEnv('sonar server'){
      sh "${mvnHome}/bin/mvn sonar:sonar"
    }
  }
  stage('checkstyle install'){
    def mvnHome = tool name: 'mvn', type: 'maven'
    sh "${mvnHome}/bin/mvn install checkstyle:checkstyle"
  }
  stage('nexus deploy'){
    def mvnHome = tool name: 'mvn', type: 'maven'
    sh "${mvnHome}/bin/mvn deploy"
  }
  stage('Nexus') {
        def pom = readMavenPom file: 'pom.xml'
        nexusArtifactUploader artifacts: [
        [artifactId: 'vprofile', 
        classifier: '', 
        file: '/var/lib/jenkins/plugins/nexus-artifact-uploader.jpi', 
        type: 'jpi']], 
        credentialsId: 'nexus-credentials', 
        groupId: 'com.visualpathit', 
        nexusUrl: '13.234.225.84:8081', 
        nexusVersion: 'nexus2', 
        protocol: 'http', 
        repository: 'maven-releases', 
        version: '5.0'
    }
}
